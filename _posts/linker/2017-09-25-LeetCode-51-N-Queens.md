---
layout: post
title: "静态链接"
date: 2017-10-08 19:00:00 +0800 
categories: linker&loader
tags: 
---
* content
{:toc}

关于链接和装载

<!-- more -->

## 静态链接

#### 目标文件

&emsp;&emsp;可执行文件格式是一种通用标准二进制文件格式，在现行的PC平台上有两种主要的可执行文件格式，一种是windows下的PE文件，一种是Linux下的ELF文件，可执行文件，目标代码，共享库文件以及核心转储文件都使用这种格式。
&emsp;&emsp;编译器编译源代码之后生成的文件叫做目标文件，从结构上讲，已经是编译后的可执行文件，只是还没有经过链接的过程，也就是说其中有些符号或有些地址还没有被调整只是未进行链接的那些中间文件，但是它本身就是按照可执行文件格式存储的，只是跟真正的可执行文件在结构上稍微有些不同。  
&emsp;&emsp;动态链接库及静态链接库文件都按照可执行文件格式存储。  
&emsp;&emsp;ELF文件标准中将系统中采用的ELF格式文件归类为，可重定位文件(目标文件？)，可执行文件，共享目标文件(动、静态链接库文件？)，核心转储文件。在linux下，用file可以查看相应文件的格式。

#### 目标文件是什么样的

&emsp;&emsp;目标文件至少包含编译后的机器指令代码，数据。除此之外还有重要的链接信息，比如符号表，调试信息，字符串。目标文件将这些以section的形式存储，有时候也称为segment，都表示一定长度的区域。机器指令放在代码段，.code 或者 .text，全局变量和局部静态变量数据经常放在数据段 .data  
$$\begin{array}{|c|}
\hline
File&Header \\
\hline
.text&section \\
\hline
.data&section \\
\hline
.bss&section \\
\hline
\end{array}$$  
&emsp;&emsp;ELF文件的开头是File Header，描述了整个文件的文件属性，文件是否可执行，是静态链接库还是动态链接库，入口地址(如果是可执行文件)，目标硬件，目标操作系统等信息，文件头还包含一个**段表**。段表描述了文件中各个段在文件中的偏移位置以及段的属性，从段表里面可以得到每个段的信息。File Header后面就是各个段的内容

